<UserControl x:Class="HospitalManagementSystem.Views.UserControls.PatientManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Background="#F4F7FC">

    <!-- Make the WHOLE view scrollable -->
    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled"
                  CanContentScroll="True">
        <Grid Margin="20" Background="White">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Header -->
                <RowDefinition Height="Auto"/>
                <!-- Form -->
                <RowDefinition Height="Auto"/>
                <!-- Buttons -->
                <RowDefinition Height="Auto"/>
                <!-- Search -->
                <RowDefinition Height="*"/>
                <!-- DataGrid -->
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Margin="10">
                <TextBlock Text="Patient Management" FontSize="28" FontWeight="Bold" Foreground="#007ACC"/>
                <Separator Margin="0,10,0,0"/>
            </StackPanel>

            <!-- Patient Form -->
            <GroupBox Grid.Row="1" Header="Patient Details" Margin="10" BorderBrush="#DDDDDD">
                <StackPanel Margin="10" Orientation="Vertical" >

                    <!-- Row 1 -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Patient Code:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtPatientCode" Grid.Column="1" Margin="0,0,10,0"/>

                        <TextBlock Grid.Column="3" Text="First Name:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtFirstName" Grid.Column="4" Margin="0,0,10,0"/>

                        <TextBlock Grid.Column="6" Text="Last Name:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtLastName" Grid.Column="7" Margin="0,0,10,0"/>
                    </Grid>

                    <!-- Row 2 -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Date of Birth:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <DatePicker x:Name="dpDOB" Grid.Column="1" Margin="0,0,10,0"/>

                        <TextBlock Grid.Column="3" Text="Gender:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="cmbGender" Grid.Column="4" Margin="0,0,10,0">
                            <ComboBoxItem Content="Male"/>
                            <ComboBoxItem Content="Female"/>
                            <ComboBoxItem Content="Other"/>
                        </ComboBox>

                        <TextBlock Grid.Column="6" Text="Active:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <CheckBox  x:Name="chkIsActive" Grid.Column="7" VerticalAlignment="Center" IsChecked="True"/>
                    </Grid>

                    <!-- Row 3 -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Phone:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtPhone" Grid.Column="1" Margin="0,0,10,0" ToolTip="10 digits or +CC + 10 digits (e.g., 9876543210 or +91 9876543210)"/>

                        <TextBlock Grid.Column="3" Text="Email:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtEmail" Grid.Column="4" Margin="0,0,10,0"/>

                        <TextBlock Grid.Column="6" Text="Blood Type:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtBloodType" Grid.Column="7" Margin="0,0,10,0" ToolTip="A+, A-, B+, B-, AB+, AB-, O+, O-"/>
                    </Grid>

                    <!-- Row 4 -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Address:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtAddress" Grid.Column="1" Margin="0,0,10,0"/>
                    </Grid>

                    <!-- Row 5 -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Emergency Contact:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtEmergencyContact" Grid.Column="1" Margin="0,0,10,0"/>

                        <TextBlock Grid.Column="3" Text="Emergency Phone:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtEmergencyPhone" Grid.Column="4" Margin="0,0,10,0" ToolTip="Optional. 10 digits or +CC + 10 digits"/>

                        <TextBlock Grid.Column="6" Text="Insurance Provider:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtInsuranceProvider" Grid.Column="7" Margin="0,0,10,0"/>
                    </Grid>

                    <!-- Row 6 -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="200"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Insurance Number:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtInsuranceNumber" Grid.Column="1" Margin="0,0,10,0"/>

                        <TextBlock Grid.Column="3" Text="Allergies:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtAllergies" Grid.Column="4" Margin="0,0,10,0"/>
                    </Grid>

                    <!-- Row 7 -->
                    <Grid Margin="0,0,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Medical Conditions:" VerticalAlignment="Top" Margin="0,0,5,0"/>
                        <TextBox  x:Name="txtMedicalConditions" Grid.Column="1" Margin="0,0,10,0" AcceptsReturn="True" Height="80" TextWrapping="Wrap"/>
                    </Grid>

                </StackPanel>
            </GroupBox>

            <!-- Buttons -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="10">
                <Button Content="Add Patient"    Click="AddPatientButton_Click"    Background="#28A745" Foreground="White" Margin="5" Padding="10,6"/>
                <Button Content="Update Patient" Click="UpdatePatientButton_Click" Background="#007ACC" Foreground="White" Margin="5" Padding="10,6"/>
                <Button Content="Delete Patient" Click="DeletePatientButton_Click" Background="#DC3545" Foreground="White" Margin="5" Padding="10,6"/>
            </StackPanel>

            <!-- Search -->
            <Grid Grid.Row="3" Margin="10,0,10,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Search by PatientID:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox   Grid.Column="1" x:Name="txtSearch" Margin="0,0,8,0"/>
                <Button    Grid.Column="2" Content="Search" Click="SearchButton_Click" Padding="10,4"/>
            </Grid>

            <!-- DataGrid -->
            <GroupBox Grid.Row="4" Header="Patients" Margin="10" BorderBrush="#DDDDDD">
                <DataGrid x:Name="PatientsDataGrid"
                          ItemsSource="{Binding Patients}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          SelectionMode="Single"
                          SelectionChanged="PatientsDataGrid_SelectionChanged"
                          Margin="6"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          AlternatingRowBackground="#F7FAFF"
                          GridLinesVisibility="Horizontal"
                          EnableRowVirtualization="True"
                          ScrollViewer.CanContentScroll="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID"            Binding="{Binding PatientID}" Width="60"/>
                        <DataGridTextColumn Header="Code"          Binding="{Binding PatientCode}" Width="100"/>
                        <DataGridTextColumn Header="First Name"    Binding="{Binding FirstName}" Width="120"/>
                        <DataGridTextColumn Header="Last Name"     Binding="{Binding LastName}" Width="120"/>
                        <DataGridTextColumn Header="DOB"           Binding="{Binding DOB, StringFormat=d}" Width="100"/>
                        <DataGridTextColumn Header="Gender"        Binding="{Binding Gender}" Width="80"/>
                        <DataGridTextColumn Header="Phone"         Binding="{Binding Phone}" Width="140"/>
                        <DataGridTextColumn Header="Email"         Binding="{Binding Email}" Width="180"/>
                        <DataGridTextColumn Header="Address"       Binding="{Binding Address}" Width="220"/>
                        <DataGridCheckBoxColumn Header="Active"    Binding="{Binding IsActive}" Width="70"/>
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>

        </Grid>
    </ScrollViewer>
</UserControl>
