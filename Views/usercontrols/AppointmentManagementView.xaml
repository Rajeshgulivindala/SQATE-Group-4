<UserControl x:Class="HospitalManagementSystem.Views.UserControls.AppointmentManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Background="#F4F7FC">

    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled"
                  CanContentScroll="True">
        <Grid Margin="16" Background="White">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Margin="12">
                <TextBlock Text="Appointment Management"
                           FontSize="26" FontWeight="Bold" Foreground="#007ACC"/>
                <Separator Margin="0,8,0,0"/>
            </StackPanel>

            <!-- Search -->
            <GroupBox Grid.Row="1" Header="Search" Margin="12" BorderBrush="#E5E7EB">
                <StackPanel Orientation="Horizontal" Margin="10">
                    <TextBlock Text="Patient ID:"
                               VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBox x:Name="txtSearchPatientId" Width="160" Margin="0,0,8,0"/>
                    <Button Content="Search" Click="SearchButton_Click" Padding="12,6"/>
                </StackPanel>
            </GroupBox>

            <!-- Form -->
            <GroupBox Grid.Row="2" Header="Appointment Details" Margin="12" BorderBrush="#E5E7EB">
                <StackPanel Margin="10" Orientation="Vertical">
                    <!-- Row 1 -->
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="260"/>
                            <ColumnDefinition Width="24"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="220"/>
                            <ColumnDefinition Width="24"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="220"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Patient:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <!-- Patient dropdown by code -->
                        <ComboBox x:Name="cmbPatient"
                                  Grid.Column="1"
                                  Width="260"
                                  IsEditable="False"
                                  IsTextSearchEnabled="True"
                                  DisplayMemberPath="Display"
                                  SelectedValuePath="PatientID"/>

                        <TextBlock Grid.Column="3" Text="Staff:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox x:Name="cmbStaff" Grid.Column="4" Width="220"
                                  DisplayMemberPath="Display" SelectedValuePath="StaffID"/>

                        <TextBlock Grid.Column="6" Text="Room:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox x:Name="cmbRoom" Grid.Column="7" Width="220"
                                  DisplayMemberPath="Display" SelectedValuePath="RoomID"/>
                    </Grid>

                    <!-- Row 2 -->
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="220"/>
                            <ColumnDefinition Width="24"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="24"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="180"/>
                            <ColumnDefinition Width="24"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="180"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Date/Time:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <DatePicker x:Name="dpAppointmentDate" Grid.Column="1"/>

                        <TextBlock Grid.Column="3" Text="Duration (min):" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBox x:Name="txtDuration" Grid.Column="4"/>

                        <TextBlock Grid.Column="6" Text="Type:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox x:Name="cmbType" Grid.Column="7"/>

                        <TextBlock Grid.Column="9" Text="Status:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox x:Name="cmbStatus" Grid.Column="10"/>
                    </Grid>

                    <!-- Row 3 -->
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Reason:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBox x:Name="txtReason" Grid.Column="1"/>
                    </Grid>

                    <!-- Row 4 -->
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Notes:" VerticalAlignment="Top" Margin="0,0,6,0"/>
                        <TextBox x:Name="txtNotes" Grid.Column="1" Height="70" AcceptsReturn="True" TextWrapping="Wrap"/>
                    </Grid>

                    <!-- Row 5 -->
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="24"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="120"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Created By:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBox x:Name="txtCreatedBy" Grid.Column="1"/>

                        <TextBlock Grid.Column="3" Text="Appointment ID:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBox x:Name="txtAppointmentID" Grid.Column="4" IsReadOnly="True"/>
                    </Grid>

                    <!-- Buttons -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Add"    Click="AddButton_Click"    Background="#28A745" Foreground="White" Padding="10,6" Margin="4"/>
                        <Button Content="Update" Click="UpdateButton_Click" Background="#007ACC" Foreground="White" Padding="10,6" Margin="4"/>
                        <Button Content="Delete" Click="DeleteButton_Click" Background="#DC3545" Foreground="White" Padding="10,6" Margin="4"/>
                    </StackPanel>
                </StackPanel>
            </GroupBox>

            <!-- Grid -->
            <GroupBox Grid.Row="3" Header="Appointments" Margin="12" BorderBrush="#E5E7EB">
                <DataGrid x:Name="AppointmentsDataGrid"
                          ItemsSource="{Binding Appointments}"
                          AutoGenerateColumns="False"
                          SelectionMode="Single"
                          IsReadOnly="True"
                          SelectionChanged="AppointmentsDataGrid_SelectionChanged"
                          Margin="6"
                          AlternatingRowBackground="#F7FAFF">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding AppointmentID}" Width="60"/>
                        <DataGridTextColumn Header="PatientID" Binding="{Binding PatientID}" Width="80"/>
                        <DataGridTextColumn Header="StaffID" Binding="{Binding StaffID}" Width="80"/>
                        <DataGridTextColumn Header="RoomID" Binding="{Binding RoomID}" Width="80"/>
                        <DataGridTextColumn Header="Date/Time" Binding="{Binding AppointmentDate, StringFormat=g}" Width="140"/>
                        <DataGridTextColumn Header="Duration" Binding="{Binding Duration}" Width="80"/>
                        <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="120"/>
                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="120"/>
                        <DataGridTextColumn Header="Reason" Binding="{Binding Reason}" Width="200"/>
                        <DataGridTextColumn Header="Notes" Binding="{Binding Notes}" Width="200"/>
                    </DataGrid.Columns>
                </DataGrid>
            </GroupBox>
        </Grid>
    </ScrollViewer>
</UserControl>
